package ru.kirill.foxgame.model;

import ru.kirill.foxgame.controller.GameController;
import ru.kirill.foxgame.logic.FoxGame;

/**
 * Представляет текущую фазу игры "Лисица на опушке".
 * Фазы определяют состояние игрового процесса и управляют потоком выполнения.
 * Переход между фазами осуществляется в строго определенном порядке,
 * соответствующем правилам игры.
 * 
 * <p>Последовательность фаз в одном кону (раунде):
 * <ol>
 *   <li>{@link #DEALING} - раздача карт</li>
 *   <li>{@link #TRUMP_SELECTION} - выбор козырной карты</li>
 *   <li>{@link #PLAYING} - игровая фаза (13 кругов)</li>
 *   <li>{@link #TRICK_COMPLETED} - завершение круга (после каждого из 13 кругов)</li>
 *   <li>{@link #ROUND_SCORING} - подсчет очков за кон</li>
 *   <li>Возврат к {@link #DEALING} для нового кона или переход к {@link #GAME_OVER}</li>
 * </ol>
 * 
 * @see FoxGame#currentPhase
 * @see GameController#updateView()
 */
public enum GamePhase {
    /**
     * Фаза раздачи карт в начале каждого кона.
     * В этой фазе:
     * <ul>
     *   <li>Перемешивается колода из 33 карт</li>
     *   <li>Каждому игроку раздается по 13 карт</li>
     *   <li>Из оставшихся 7 карт формируется колода</li>
     *   <li>Определяется козырная карта (карта указа)</li>
     * </ul>
     * Длительность: до завершения раздачи всех карт.
     * Следующая фаза: {@link #TRUMP_SELECTION}.
     */
    DEALING("Раздача карт"),

     /**
     * Фаза выбора козырной карты.
     * В этой фазе:
     * <ul>
     *   <li>Верхняя карта из колоды переворачивается лицевой стороной вверх</li>
     *   <li>Масть этой карты становится козырной мастью на весь кон</li>
     *   <li>Карта остается на столе как видимый указатель козыря</li>
     * </ul>
     * Длительность: мгновенная (после определения карты указа).
     * Следующая фаза: {@link #PLAYING}.
     */
    TRUMP_SELECTION("Выбор козыря"),

    /**
     * Активная фаза игры, в которой игроки разыгрывают карты.
     * В этой фазе:
     * <ul>
     *   <li>Проводятся 13 кругов (взяток)</li>
     *   <li>В каждом круге ведущий и отвечающий играют по одной карте</li>
     *   <li>Определяется победитель каждого круга</li>
     *   <li>Применяются эффекты особых карт</li>
     *   <li>Победитель круга становится ведущим в следующем круге</li>
     * </ul>
     * Длительность: до завершения 13 кругов.
     * Переходы: после каждого круга кратковременный переход в {@link #TRICK_COMPLETED},
     * затем возврат в {@link #PLAYING} для следующего круга.
     * После 13 кругов следующая фаза: {@link #ROUND_SCORING}.
     */
    PLAYING("Игра"),

    /**
     * Фаза завершения отдельного круга (взятки).
     * В этой фазе:
     * <ul>
     *   <li>Определяется победитель круга</li>
     *   <li>Карты круга убираются со стола</li>
     *   <li>Счет побед игроков обновляется</li>
     *   <li>Определяется ведущий для следующего круга</li>
     * </ul>
     * Длительность: кратковременная (переходная фаза).
     * Следующая фаза: {@link #PLAYING} для следующего круга или
     * {@link #ROUND_SCORING} после 13 кругов.
     */
    TRICK_COMPLETED("Круг завершен"),

    /**
     * Фаза подсчета очков в конце кона.
     * В этой фазе:
     * <ul>
     *   <li>Подсчитывается количество кругов, выигранных каждым игроком</li>
     *   <li>По таблице очков определяются очки за кон</li>
     *   <li>Очки добавляются к общему счету игроков</li>
     *   <li>Проверяется, не достиг ли кто-либо из игроков 21 очка</li>
     * </ul>
     * Длительность: до завершения подсчета.
     * Следующая фаза: {@link #DEALING} для нового кона или {@link #GAME_OVER},
     * если кто-то набрал 21+ очков.
     * 
     * @see GameState#calculatePointsForTricks(int)
     */
    ROUND_SCORING("Подсчет очков за кон"),

    /**
     * Фаза завершенной игры.
     * Наступает, когда один из игроков набирает 21 или более очков.
     * В этой фазе:
     * <ul>
     *   <li>Определяется победитель игры</li>
     *   <li>Игровой процесс полностью останавливается</li>
     *   <li>Предлагается начать новую игру</li>
     * </ul>
     * Длительность: до перезапуска игры.
     * 
     * @see FoxGame#isGameOver()
     * @see GameController#handleGameOver()
     */
    GAME_OVER("Игра завершена");
    
    private final String description;
    
    /**
     * Создает элемент перечисления GamePhase с описанием на русском языке.
     * 
     * @param description текстовое описание фазы на русском языке,
     *                    используемое для отображения в пользовательском интерфейсе
     */
    GamePhase(String description) {
        this.description = description;
    }
    
    /**
     * Возвращает текстовое описание фазы игры на русском языке.
     * 
     * @return строковое описание фазы, подходящее для отображения пользователю
     */
    @Override
    public String toString() {
        return description;
    }
}
